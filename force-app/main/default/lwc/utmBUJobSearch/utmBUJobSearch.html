<template>
  <!-- üîç Ê§úÁ¥¢„Éï„Ç©„Éº„É† -->
  <div class="custom-card">
    <div class="search-conditions-area">
      
      <!-- 1Ë°åÁõÆÔºö„Ç≠„Éº„ÉØ„Éº„ÉâÂÖ•Âäõ -->
      <div class="search-row">
        <div class="keyword-wrapper"> 
        <input
          type="text"
          id="keyword"
          class="slds-input keyword-input"
          value={keyword}
          placeholder="Âú∞Âüü„ÉªËÅ∑Á®Æ„Éª„Ç≠„Éº„ÉØ„Éº„Éâ"
          oninput={handleKeywordChange}
          onkeydown={handleKeyDown}
        />
        <template if:true={keyword}>
          <button class="clear-button" onclick={clearKeyword}>‚úñÔ∏è</button>
        </template>
      </div>  
      </div>
      
      <!-- 2Ë°åÁõÆÔºöÊù°‰ª∂ËøΩÂä† + Ê§úÁ¥¢„Éú„Çø„É≥ -->
      <div class="filter-row">
        <button class="keyword-like-button" 
        data-has-conditions={hasConditionsAttribute} 
        onclick={toggleFilters}>
          Ôºã <span class="summary-text">{summaryText}</span>
        </button>
        <button class="slds-button slds-search-button1" onclick={handleSearch}>Ê§úÁ¥¢</button>
      </div>

      <!-- 3Ë°åÁõÆÔºö‰ΩìÈ®ìÂøúÂãü„ÉÅ„Çß„ÉÉ„ÇØ„Éú„ÉÉ„ÇØ„Çπ -->
      <div class="experience-checkbox-row">
        <lightning-input 
          type="checkbox" 
          label="‰ΩìÈ®ìÂøúÂãü" 
          value="‰ΩìÈ®ìÂøúÂãü" 
          checked={isCheckedExperience}
          onchange={handleExperienceCheckboxChange}
          class="experience-checkbox">
        </lightning-input>
      </div>

    </div>
  </div>

  <!-- üîΩ Êù°‰ª∂ÂÖ•Âäõ„É¢„Éº„ÉÄ„É´ -->
  <template if:true={showFilters}>
    <section role="dialog" tabindex="-1" class="modal-backdrop" onclick={handleModalBackdropClick}>
      <div class="modal-container" onclick={stopPropagation}>
        <div class="modal-header">
          <h2 class="modal-title">Êù°‰ª∂ËøΩÂä†</h2>
          <button class="modal-reset-button" onclick={handleClearAll}>„É™„Çª„ÉÉ„Éà</button>
        </div>

        <div class="modal-body">

          <!-- ÂÉç„ÅçÊñπ & ‰ºëÊó• -->
          <div class="holiday-wage-row">
            <div class="work-style-block">
              <label class="slds-form-element__label">ÂÉç„ÅçÊñπ</label>
              <div class="checkbox-row">
                <lightning-input type="checkbox" label="Ê≠£Á§æÂì°" value="Ê≠£Á§æÂì°" checked={isCheckedÊ≠£Á§æÂì°} onchange={handleWorkStyleCheckboxChange}></lightning-input>
                <lightning-input type="checkbox" label="ËªΩ‰ΩúÊ•≠" value="ËªΩ‰ΩúÊ•≠" checked={isCheckedËªΩ‰ΩúÊ•≠} onchange={handleWorkStyleCheckboxChange}></lightning-input>
                <lightning-input type="checkbox" label="Êú™ÁµåÈ®ìOK" value="Êú™ÁµåÈ®ìOK" checked={isCheckedÊú™ÁµåÈ®ìOK} onchange={handleWorkStyleCheckboxChange}></lightning-input>
                <lightning-input type="checkbox" label="Êâ∂È§äÂÜÖ" value="Êâ∂È§äÂÜÖ" checked={isCheckedÊâ∂È§äÂÜÖ} onchange={handleWorkStyleCheckboxChange}></lightning-input>
                <lightning-input type="checkbox" label="„Ç∑„Éã„Ç¢" value="„Ç∑„Éã„Ç¢" checked={isChecked„Ç∑„Éã„Ç¢} onchange={handleWorkStyleCheckboxChange}></lightning-input>
              </div>
            </div>

            <div class="holiday-block">
              <label class="slds-form-element__label">Â∏åÊúõ‰ºëÊó•</label>
              <div class="checkbox-row">
                <lightning-input type="checkbox" label="Âúü" value="Âúü" checked={isCheckedÂúü} onchange={handleHolidayCheckboxChange}></lightning-input>
                <lightning-input type="checkbox" label="Êó•" value="Êó•" checked={isCheckedÊó•} onchange={handleHolidayCheckboxChange}></lightning-input>
                <lightning-input type="checkbox" label="Á•ù" value="Á•ù" checked={isCheckedÁ•ù} onchange={handleHolidayCheckboxChange}></lightning-input>
              </div>
            </div>
          </div>

          <!-- ÊôÇÁµ¶„Çπ„É©„Ç§„ÉÄ„Éº -->
          <div class="wage-slider-block">
            <label class="slds-form-element__label">ÊôÇÁµ¶Ôºà{formattedMinWage}ÂÜÜ‰ª•‰∏äÔºâ</label>
            <input
              type="range"
              min="900"
              max="2000"
              step="50"
              value={minWage}
              oninput={handleMinWageChangeCustom}
              class="custom-range"
            />
          </div>

          <!-- Âã§ÂãôÊôÇÈñì -->
          <div class="modal-row time-inputs">
            <lightning-input
              type="time"
              label="Âã§ÂãôÈñãÂßãÊôÇÈñì"
              name="startTime"
              value={startTime}
              step="900"
              onchange={handleStartTimeChange}>
            </lightning-input>

            <lightning-input
              type="time"
              label="Âã§ÂãôÁµÇ‰∫ÜÊôÇÈñì"
              name="endTime"
              value={endTime}
              step="900"
              onchange={handleEndTimeChange}>
            </lightning-input>
          </div>
        </div>

        <!-- „Éï„ÉÉ„Çø„ÉºÔºö„Ç≠„É£„É≥„Çª„É´/Ê§úÁ¥¢ -->
        <div class="modal-footer-button-row">
          <button class="slds-button slds-button_neutral cancel-button" onclick={toggleFilters}>
            „Ç≠„É£„É≥„Çª„É´
          </button>
          <button class="slds-button slds-button_brand search-button" onclick={handleSearchAndClose}>
            Ê§úÁ¥¢
          </button>
        </div>
      </div>
    </section>
  </template>

  <!-- üîç Ê§úÁ¥¢ÁµêÊûú -->
  <template if:true={hasSearched}>
    
      <!-- üîç Ê§úÁ¥¢ÁµêÊûú‰ª∂Êï∞ + „ÇΩ„Éº„Éà + „ÇØ„É™„Ç¢ -->
      
     <!-- üîç Ê§úÁ¥¢ÁµêÊûú‰ª∂Êï∞ + „ÇΩ„Éº„Éà + „ÇØ„É™„Ç¢ -->
     <div class="result-header">
      <!-- Â∑¶Ôºö‰ª∂Êï∞ -->
      <p class="slds-m-top_small">
        <template if:true={isNoResults}>
          Ë©≤ÂΩìÊ±Ç‰∫∫0‰ª∂
        </template>
        <template if:false={isNoResults}>
          {results.length}‰ª∂‰ª•‰∏ä„ÅÆÊ±Ç‰∫∫
        </template>
      </p>
    
      <!-- Âè≥Ôºö„ÇΩ„Éº„Éà + „ÇØ„É™„Ç¢ -->
      <div class="result-actions">
        <template if:false={isNoResults}>
          <select class="sort-combobox" onchange={handleSortChangeNative}>
            <option value="wageDesc">ÊôÇÁµ¶„ÅåÈ´ò„ÅÑ</option>
            <option value="startTimeAsc">ÈñãÂßãÊôÇÈñì„ÅåÊó©„ÅÑ</option>
            <option value="startTimeDesc">ÈñãÂßãÊôÇÈñì„ÅåÈÅÖ„ÅÑ</option>
            <option value="endTimeAsc">ÁµÇ‰∫ÜÊôÇÈñì„ÅåÊó©„ÅÑ</option>
            <option value="endTimeDesc">ÁµÇ‰∫ÜÊôÇÈñì„ÅåÈÅÖ„ÅÑ</option>
          </select>
        </template>
    
        <!-- ‚úÖ „Åì„Åì„ÅØÁÑ°Êù°‰ª∂Ë°®Á§∫ -->
        <button class="clear-all-button" onclick={handleClearAll}>Èñâ„Åò„Çã</button>
      </div>
    </div>

      
      

    



    
    <template for:each={paginatedResults} for:item="job">

      <div key={job.Id} class="job-card" onclick={handleJobDetailNavigation} data-record-id={job.Id}>
        <p class="job-title"><strong>{job.joboffer__r.Field1702__c}</strong></p>
        <div class="job-layout">
          <div class="job-info">
            <!-- ‰ºöÁ§æÂêç -->
            <div class="job-info-row">
              <!-- ‰ºöÁ§æ„Ç¢„Ç§„Ç≥„É≥ -->
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512" width="16" height="16" style="fill:#7d8085;">
                <path d="M48 0C21.5 0 0 21.5 0 48V464c0 26.5 21.5 48 48 48h96V432c0-26.5 21.5-48 48-48s48 21.5 48 48v80h96c26.5 0 48-21.5 48-48V48c0-26.5-21.5-48-48-48H48zM64 240c0-8.8 7.2-16 16-16h32c8.8 0 16 7.2 16 16v32c0 8.8-7.2 16-16 16H80c-8.8 0-16-7.2-16-16V240zm112-16h32c8.8 0 16 7.2 16 16v32c0 8.8-7.2 16-16 16H176c-8.8 0-16-7.2-16-16V240c0-8.8 7.2-16 16-16zm80 16c0-8.8 7.2-16 16-16h32c8.8 0 16 7.2 16 16v32c0 8.8-7.2 16-16 16H272c-8.8 0-16-7.2-16-16V240zM80 96h32c8.8 0 16 7.2 16 16v32c0 8.8-7.2 16-16 16H80c-8.8 0-16-7.2-16-16V112c0-8.8 7.2-16 16-16zm80 16c0-8.8 7.2-16 16-16h32c8.8 0 16 7.2 16 16v32c0 8.8-7.2 16-16 16H176c-8.8 0-16-7.2-16-16V112zm112 16h32c8.8 0 16 7.2 16 16v32c0 8.8-7.2 16-16 16H272c-8.8 0-16-7.2-16-16V112c0-8.8 7.2-16 16-16z"/>
              </svg>
              <span class="job-text">{job.Destination__c}</span>
            </div>

            <!-- ‰ΩèÊâÄ -->
            <div class="job-info-row">
              <!-- ‰ΩèÊâÄ„Ç¢„Ç§„Ç≥„É≥ -->
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512" width="16" height="16" style="fill:#7d8085;">
                <path d="M215.7 499.2C267 435 384 279.4 384 192C384 86 298 0 192 0S0 86 0 192c0 87.4 117 243 168.3 307.2c12.3 15.3 35.1 15.3 47.4 0zM192 128a64 64 0 1 1 0 128 64 64 0 1 1 0-128z"/>
              </svg>
              <span class="job-text">{job.joboffer__r.Field1624__c}</span>
            </div>
          
            <!-- ËÅ∑Á®ÆÔºàÈõáÁî®ÂΩ¢ÊÖã‰ªò„ÅçÔºâ -->
            <div class="job-info-row">
              <!-- ËÅ∑Á®Æ„Ç¢„Ç§„Ç≥„É≥ -->
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="16" height="16" style="fill:#7d8085;">
                <path d="M184 48l144 0c4.4 0 8 3.6 8 8l0 40L176 96l0-40c0-4.4 3.6-8 8-8zm-56 8l0 40L64 96C28.7 96 0 124.7 0 160l0 96 192 0 128 0 192 0 0-96c0-35.3-28.7-64-64-64l-64 0 0-40c0-30.9-25.1-56-56-56L184 0c-30.9 0-56 25.1-56 56zM512 288l-192 0 0 32c0 17.7-14.3 32-32 32l-64 0c-17.7 0-32-14.3-32-32l0-32L0 288 0 416c0 35.3 28.7 64 64 64l384 0c35.3 0 64-28.7 64-64l0-128z"/>
              </svg>
              <span class="job-text">
                {job.joboffer__r.BusinessContent_sub__c}<template if:true={job.EmploymentStatus__c}><span class="employment-type-text">ÔΩú{job.EmploymentStatus__c}</span></template>
              </span>
            </div>
          
            <div class="job-info-row">
              <!-- Áµ¶‰∏é„Ç¢„Ç§„Ç≥„É≥ -->
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="16" height="16" style="fill:#7d8085;">
                <path d="M512 80c0 18-14.3 34.6-38.4 48c-29.1 16.1-72.5 27.5-122.3 30.9c-3.7-1.8-7.4-3.5-11.3-5C300.6 137.4 248.2 128 192 128c-8.3 0-16.4 .2-24.5 .6l-1.1-.6C142.3 114.6 128 98 128 80c0-44.2 86-80 192-80S512 35.8 512 80zM160.7 161.1c10.2-.7 20.7-1.1 31.3-1.1c62.2 0 117.4 12.3 152.5 31.4C369.3 204.9 384 221.7 384 240c0 4-.7 7.9-2.1 11.7c-4.6 13.2-17 25.3-35 35.5c0 0 0 0 0 0c-.1 .1-.3 .1-.4 .2c0 0 0 0 0 0s0 0 0 0c-.3 .2-.6 .3-.9 .5c-35 19.4-90.8 32-153.6 32c-59.6 0-112.9-11.3-148.2-29.1c-1.9-.9-3.7-1.9-5.5-2.9C14.3 274.6 0 258 0 240c0-34.8 53.4-64.5 128-75.4c10.5-1.5 21.4-2.7 32.7-3.5zM416 240c0-21.9-10.6-39.9-24.1-53.4c28.3-4.4 54.2-11.4 76.2-20.5c16.3-6.8 31.5-15.2 43.9-25.5l0 35.4c0 19.3-16.5 37.1-43.8 50.9c-14.6 7.4-32.4 13.7-52.4 18.5c.1-1.8 .2-3.5 .2-5.3zm-32 96c0 18-14.3 34.6-38.4 48c-1.8 1-3.6 1.9-5.5 2.9C304.9 404.7 251.6 416 192 416c-62.8 0-118.6-12.6-153.6-32C14.3 370.6 0 354 0 336l0-35.4c12.5 10.3 27.6 18.7 43.9 25.5C83.4 342.6 135.8 352 192 352s108.6-9.4 148.1-25.9c7.8-3.2 15.3-6.9 22.4-10.9c6.1-3.4 11.8-7.2 17.2-11.2c1.5-1.1 2.9-2.3 4.3-3.4l0 3.4 0 5.7 0 26.3zm32 0l0-32 0-25.9c19-4.2 36.5-9.5 52.1-16c16.3-6.8 31.5-15.2 43.9-25.5l0 35.4c0 10.5-5 21-14.9 30.9c-16.3 16.3-45 29.7-81.3 38.4c.1-1.7 .2-3.5 .2-5.3zM192 448c56.2 0 108.6-9.4 148.1-25.9c16.3-6.8 31.5-15.2 43.9-25.5l0 35.4c0 44.2-86 80-192 80S0 476.2 0 432l0-35.4c12.5 10.3 27.6 18.7 43.9 25.5C83.4 438.6 135.8 448 192 448z"/>
              </svg>
              <span class="job-text">{job.joboffer__r.Field1585__c} {job.formattedSalaryMin}ÂÜÜ „Äú {job.formattedSalaryMax}ÂÜÜ</span>
            </div>
          
            <div class="job-info-row">
              <!-- ÊôÇË®à„Ç¢„Ç§„Ç≥„É≥ -->
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" width="16" height="16" style="fill:#7d8085;">
                <path d="M256 0a256 256 0 1 1 0 512A256 256 0 1 1 256 0zM232 120l0 136c0 8 4 15.5 10.7 20l96 64c11 7.4 25.9 4.4 33.3-6.7s4.4-25.9-6.7-33.3L280 243.2 280 120c0-13.3-10.7-24-24-24s-24 10.7-24 24z"/>
              </svg>
              <span class="job-text">{job.formattedTimeDisplay}</span>
            </div>
          </div>
          
          <div class="job-image-box">
            <template if:true={job.eyecatch_url__c}>
              <img src={job.eyecatch_url__c} alt="ÁîªÂÉè" class="job-image" />
            </template>
          </div>
        </div>
        <div class="job-pr">
          <lightning-formatted-rich-text value={job.PRPR_point3__c}></lightning-formatted-rich-text>
        </div>
      </div>
    </template>


    <!-- „ÇÇ„Å£„Å®Ë¶ã„Çã -->
    <template if:true={hasMoreResults}>
      <div class="load-more-button-wrapper">
        <button class="load-more-button" onclick={handleLoadMore}>„ÇÇ„Å£„Å®Ë¶ã„Çã</button>
      </div>
    </template>





  </template>

  
</template>