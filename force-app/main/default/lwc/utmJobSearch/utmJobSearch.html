<template>
  <!-- üîç Ê§úÁ¥¢„Éï„Ç©„Éº„É† -->
  <div class="custom-card">
    <div class="search-conditions-area">
      
      <!-- 1Ë°åÁõÆÔºö„Ç≠„Éº„ÉØ„Éº„ÉâÂÖ•Âäõ -->
      <div class="search-row">
        <input
          type="text"
          id="keyword"
          class="slds-input keyword-input"
          value={keyword}
          placeholder="Âú∞Âüü„ÉªËÅ∑Á®Æ„Éª„Ç≠„Éº„ÉØ„Éº„Éâ"
          oninput={handleKeywordChange}
          onkeydown={handleKeyDown}
        />
      </div>

      <!-- 2Ë°åÁõÆÔºöÊù°‰ª∂ËøΩÂä† + Ê§úÁ¥¢„Éú„Çø„É≥ -->
      <div class="filter-row">
        <button class="keyword-like-button" onclick={toggleFilters}>
          Ôºã <span class="summary-text">{summaryText}</span>
        </button>
        <button class="slds-button slds-search-button1" onclick={handleSearch}>Ê§úÁ¥¢</button>
      </div>

    </div>
  </div>

  <!-- üîΩ Êù°‰ª∂ÂÖ•Âäõ„É¢„Éº„ÉÄ„É´ -->
  <template if:true={showFilters}>
    <section role="dialog" tabindex="-1" class="modal-backdrop" onclick={handleModalBackdropClick}>
      <div class="modal-container" onclick={stopPropagation}>
        <div class="modal-header">
          <h2 class="modal-title">Êù°‰ª∂ËøΩÂä†</h2>
          <button class="modal-reset-button" onclick={handleClearAll}>„É™„Çª„ÉÉ„Éà</button>
        </div>

        <div class="modal-body">

          <!-- ÂÉç„ÅçÊñπ & ‰ºëÊó• -->
          <div class="filter-area holiday-wage-row">
            <div class="work-style-block">
              <label class="slds-form-element__label">ÂÉç„ÅçÊñπ</label>
              <div class="checkbox-row">
                <lightning-input type="checkbox" label="Ê≠£Á§æÂì°" value="Ê≠£Á§æÂì°" checked={isCheckedÊ≠£Á§æÂì°} onchange={handleWorkStyleCheckboxChange}></lightning-input>
                <lightning-input type="checkbox" label="ËªΩ‰ΩúÊ•≠" value="ËªΩ‰ΩúÊ•≠" checked={isCheckedËªΩ‰ΩúÊ•≠} onchange={handleWorkStyleCheckboxChange}></lightning-input>
                <lightning-input type="checkbox" label="Êú™ÁµåÈ®ìOK" value="Êú™ÁµåÈ®ìOK" checked={isCheckedÊú™ÁµåÈ®ìOK} onchange={handleWorkStyleCheckboxChange}></lightning-input>
                <lightning-input type="checkbox" label="Êâ∂È§äÂÜÖ" value="Êâ∂È§äÂÜÖ" checked={isCheckedÊâ∂È§äÂÜÖ} onchange={handleWorkStyleCheckboxChange}></lightning-input>
                <lightning-input type="checkbox" label="„Ç∑„Éã„Ç¢" value="„Ç∑„Éã„Ç¢" checked={isChecked„Ç∑„Éã„Ç¢} onchange={handleWorkStyleCheckboxChange}></lightning-input>
              </div>
            </div>

            <div class="holiday-block">
              <label class="slds-form-element__label">Â∏åÊúõ‰ºëÊó•</label>
              <div class="checkbox-row">
                <lightning-input type="checkbox" label="Âúü" value="Âúü" checked={isCheckedÂúü} onchange={handleHolidayCheckboxChange}></lightning-input>
                <lightning-input type="checkbox" label="Êó•" value="Êó•" checked={isCheckedÊó•} onchange={handleHolidayCheckboxChange}></lightning-input>
                <lightning-input type="checkbox" label="Á•ù" value="Á•ù" checked={isCheckedÁ•ù} onchange={handleHolidayCheckboxChange}></lightning-input>
              </div>
            </div>
          </div>

          <!-- ÊôÇÁµ¶„Çπ„É©„Ç§„ÉÄ„Éº -->
          <div class="wage-slider-block">
            <label class="slds-form-element__label">ÊôÇÁµ¶Ôºà{formattedMinWage}ÂÜÜ‰ª•‰∏äÔºâ</label>
            <input
              type="range"
              min="900"
              max="2000"
              step="50"
              value={minWage}
              oninput={handleMinWageChangeCustom}
              class="custom-range"
            />
          </div>

          <!-- Âã§ÂãôÊôÇÈñì -->
          <div class="modal-row time-inputs">
            <lightning-input
              type="time"
              label="Âã§ÂãôÈñãÂßãÊôÇÈñì"
              name="startTime"
              value={startTime}
              step="900"
              onchange={handleStartTimeChange}>
            </lightning-input>

            <lightning-input
              type="time"
              label="Âã§ÂãôÁµÇ‰∫ÜÊôÇÈñì"
              name="endTime"
              value={endTime}
              step="900"
              onchange={handleEndTimeChange}>
            </lightning-input>
          </div>
        </div>

        <!-- „Éï„ÉÉ„Çø„ÉºÔºö„Ç≠„É£„É≥„Çª„É´/Ê§úÁ¥¢ -->
        <div class="modal-footer-button-row">
          <button class="slds-button slds-button_neutral cancel-button" onclick={toggleFilters}>
            „Ç≠„É£„É≥„Çª„É´
          </button>
          <button class="slds-button slds-button_brand search-button" onclick={handleSearchAndClose}>
            Ê§úÁ¥¢
          </button>
        </div>
      </div>
    </section>
  </template>

  <!-- üîç Ê§úÁ¥¢ÁµêÊûú -->
  <template if:true={results}>
    <p class="slds-m-top_small">Ê§úÁ¥¢ÁµêÊûú‰ª∂Êï∞: {results.length}</p>
    <template for:each={results} for:item="job">
      <div key={job.Id} class="job-card" onclick={handleJobDetailNavigation} data-record-id={job.Id}>
        <p class="job-title"><strong>{job.joboffer__r.Field1702__c}</strong></p>
        <div class="job-layout">
          <div class="job-info">
            <div class="job-info-row">
              <lightning-icon icon-name="utility:location" size="x-small" variant="bare"></lightning-icon>
              <span class="job-text">{job.joboffer__r.Field1624__c}</span>
            </div>
            <div class="job-info-row">
              <lightning-icon icon-name="utility:user" size="x-small" variant="bare"></lightning-icon>
              <span class="job-text">{job.joboffer__r.BusinessContent_sub__c}</span>
            </div>
            <div class="job-info-row">
              <lightning-icon icon-name="utility:money" size="x-small" variant="bare"></lightning-icon>
              <span class="job-text">{job.joboffer__r.Field1585__c} {job.formattedSalaryMin}ÂÜÜ „Äú {job.formattedSalaryMax}ÂÜÜ</span>
            </div>
            <div class="job-info-row">
              <lightning-icon icon-name="utility:clock" size="x-small" variant="bare"></lightning-icon>
              <span class="job-text">{job.joboffer__r.StartTime1__c} „Äú {job.joboffer__r.EndTime1__c}</span>
            </div>
            <div class="job-info-row">
              <lightning-icon icon-name="utility:event" size="x-small" variant="bare"></lightning-icon>
              <span class="job-text">{job.joboffer__r.Field1908__c} ‰ºë„Åø</span>
            </div>
          </div>
          <div class="job-image-box">
            <template if:true={job.eyecatch_url__c}>
              <img src={job.eyecatch_url__c} alt="ÁîªÂÉè" class="job-image" />
            </template>
          </div>
        </div>
        <div class="job-pr">
          <lightning-formatted-rich-text value={job.PR_point3__c}></lightning-formatted-rich-text>
        </div>
      </div>
    </template>
  </template>

  <template if:true={isNoResults}>
    <p class="slds-m-top_small">Ë©≤ÂΩì„Åô„ÇãÊ±Ç‰∫∫„ÅØ„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ</p>
  </template>
</template>
